# 2024-01-25
----------------
# ğŸƒ Springboot 

## Data Annotation
### @EnableJpaAuditing
> ê°ì‚¬(Auditing) ê¸°ëŠ¥ì„ í™œì„±í™” í•œë‹¤. Entity ì˜ ìƒì„±ì¼ì(@CreatedDate), ë§ˆì§€ë§‰ ìˆ˜ì •ì¼ì(@LastModifiedDate)ë¥¼ ìë™ìœ¼ë¡œ ê´€ë¦¬ í•  ìˆ˜ ìˆë‹¤.

- ë³´í†µ Application ì— ì‘ì„±í•˜ì—¬ ì ìš©í•œë‹¤.
<br>  

```java
import org.springframework.boot.SpringApplication;
import org.springframework.boot.autoconfigure.SpringBootApplication;
import org.springframework.data.jpa.repository.config.EnableJpaAuditing;

@EnableJpaAuditing // Application ì— ì‘ì„±í•˜ì—¬ ì ìš©í•œë‹¤.
@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        SpringApplication.run(Application.class, args);
    }
}
```
<br><br>

### @CreatedDate
> Entity ì˜ ìƒì„± ì‹œê°„ì„ ìë™ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©í•œë‹¤.

- Entity ê°€ ìƒì„±ë˜ì–´ ì €ì¥ë  ë•Œì˜ ì‹œê°„ì´ í•´ë‹¹ í•„ë“œì— ìë™ìœ¼ë¡œ í• ë‹¹ëœë‹¤.

<br><br>

### @LastModifiedDate
> Entity ì˜ ë§ˆì§€ë§‰ ìˆ˜ì • ì‹œê°„ì„ ìë™ìœ¼ë¡œ ê´€ë¦¬í•œë‹¤.

- Entity ê°€ ì—…ë°ì´íŠ¸ë  ë•Œë§ˆë‹¤ í•´ë‹¹ í•„ë“œì— í˜„ì¬ ì‹œê°„ì´ ìë™ìœ¼ë¡œ í• ë‹¹ëœë‹¤.

<br><br>



```java
import jakarta.persistence.*;
import lombok.AccessLevel;
import lombok.Builder;
import lombok.Getter;
import lombok.NoArgsConstructor;
import org.springframework.data.annotation.CreatedDate;
import org.springframework.data.annotation.LastModifiedDate;

import java.time.LocalDateTime;

@Entity
@Getter
@NoArgsConstructor(access = AccessLevel.PROTECTED)
public class Article {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id", updatable = false)
    private Long id;

    @Column(name= "title", nullable = false)
    private String title;

    @Column(name = "content", nullable = false)
    private String content;

    @CreatedDate
    @Column(name = "created_at")
    private LocalDateTime createdAt;

    @LastModifiedDate
    @Column(name = "updated_at")
    private LocalDateTime updatedAt;

    @Builder
    public Article(String title, String content) {
        this.title = title;
        this.content = content;
    }

    public void update(String title, String content) {
        this.title = title;
        this.content = content;
    }
}

```
<br><br>


## Web Annotation
### @PathVariable
> URIì˜ ì¼ë¶€ë¥¼ ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ë°”ì¸ë”©í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.

- @RequestMapping ë˜ëŠ” @GetMapping, @PostMapping ë“±ê³¼ ê°™ì€ ê³³ì— ì“°ì´ëŠ” ë³€ìˆ˜ë¥¼ ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì „ë‹¬í•œë‹¤.

```java
import org.springframework.web.bind.annotation.PathVariable;
// @Controller ë‚´ë¶€ . . .

    @GetMapping("/articles/{id}") // URI ì—ì„œ ì‚¬ìš©ë˜ëŠ” id ê°’ì„
    public String getArticle(@PathVariable Long id, Model model) { // ë©”ì„œë“œì˜ ë§¤ê°œë³€ìˆ˜ë¡œ ì‚¬ìš© ê°€ëŠ¥
        Article article = blogService.findById(id);
        model.addAttribute("article",new ArticleViewResponse(article));

        return "article";
    }

    // . . .
```

<br><br><br>  


## Security > UserDetails, UserDetailsService ?
### UserDetails
> Spring Security ì—ì„œ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ìº¡ìŠí™” í•˜ëŠ” ì¸í„°í˜ì´ìŠ¤
- ì‚¬ìš©ìì˜ ì¸ì¦ì— í•„ìš”í•œ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ë©”ì„œë“œë¥¼ ì •ì˜í•œë‹¤.
    - getUsername() : ì‚¬ìš©ìì˜ ìœ ë‹ˆí¬ í•œ ê°’ ë°˜í™˜ (ex ID)
    - getPassword() : ì‚¬ìš©ìì˜ í•´ì‹±ëœ ë¹„ë°€ë²ˆí˜¸ ë°˜í™˜
    - getAuthorities() : ì‚¬ìš©ìì—ê²Œ ë¶€ì—¬ëœ ê¶Œí•œì„ ë°˜í™˜í•œë‹¤.   
    => GrantedAuthority ì¸í„°í˜ì´ìŠ¤ë¥¼ êµ¬í˜„í•œ ê°ì²´ì˜ ì»¬ë ‰ì…˜ì´ë‹¤.
    - isAccountNonExpired() : ê³„ì •ì´ ë§Œë£Œë˜ì§€ ì•Šì•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ë°˜í™˜
    - isAccountNonLocked() : ê³„ì •ì´ ì ê²¨ìˆì§€ ì•Šì€ì§€ ì—¬ë¶€ë¥¼ ë°˜í™˜
    - isCredentialsNonExpired() : ì‚¬ìš©ìì˜ ì¸ì¦ ì •ë³´(ë¹„ë°€ë²ˆí˜¸)ê°€ ë§Œë£Œë˜ì§€ ì•Šì•˜ëŠ”ì§€ ì—¬ë¶€ë¥¼ ë°˜í™˜
    - isEnabled() : ê³„ì •ì´ í™œì„±í™”ë˜ì–´ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ ë°˜í™˜

```java
@Table(name="users") // Table
@NoArgsConstructor
@Getter
@Entity
public class User implements UserDetails { // UserDetailsë¥¼ ìƒì†ë°›ì•„ì„œ ì¸ì¦ ê°ì²´ë¡œ ì‚¬ìš©
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    @Column(name = "id", updatable = false)
    private Long id;

    @Column(name="email", nullable = false, unique = true)
    private String email;

    @Column(name="password")
    private String password;

    @Builder
    public User(String email, String password, String auth) {
        this.email = email;
        this.password = password;
    }

    @Override   // ê¶Œí•œë°˜í™˜
    public Collection<? extends GrantedAuthority> getAuthorities() {
        return List.of(new SimpleGrantedAuthority("user"));
    }

    // ì‚¬ìš©ìì˜ idë¥¼ ë°˜í™˜(ê³ ìœ í•œ ê°’)
    @Override
    public String getUsername() {
        return email;
    }

    // ì‚¬ìš©ìì˜ íŒ¨ìŠ¤ì›Œë“œ ë°˜í™˜(ê³ ìœ í•œ ê°’)
    @Override
    public String getPassword(){
        return password;
    }

    // ê³„ì • ë§Œë£Œ ì—¬ë¶€ ë°˜í™˜
    @Override
    public boolean isAccountNonExpired(){
        // ë§Œë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¡œì§
        return true;    // true -> ë§Œë£Œë˜ì§€ ì•Šì•˜ìŒ
    }

    // ê³„ì • ì ê¸ˆ ì—¬ë¶€ ë°˜í™˜
    @Override
    public boolean isAccountNonLocked(){
        // ê³„ì •ì´ ì ê¸ˆë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¡œì§
        return true;    // true -> ì ê¸ˆë˜ì§€ ì•Šì•˜ìŒ
    }

    // íŒ¨ìŠ¤ì›Œë“œì˜ ë§Œë£Œ ì—¬ë¶€ ë°˜í™˜
    @Override
    public boolean isCredentialsNonExpired(){
        // íŒ¨ìŠ¤ì›Œë“œê°€ ë§Œë£Œë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë¡œì§
        return true; // true -> ë§Œë£Œë˜ì§€ ì•Šì•˜ìŒ
    }

    // ê³„ì • ì‚¬ìš© ê°€ëŠ¥ ì—¬ë¶€ ë°˜í™˜
    @Override
    public boolean isEnabled(){
        // ê³„ì •ì´ ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ëŠ” ë¡œì§
        return true;    // true -> ì‚¬ìš© ê°€ëŠ¥
    }
}
```

# ì •ë³´ì²˜ë¦¬ê¸°ì‚¬ í•„ê¸° ê³µë¶€
SEC.152 ~ SEC.154 + ì–´ì œ ë¶„ëŸ‰ ë³µìŠµ