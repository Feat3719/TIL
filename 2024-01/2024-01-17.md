# 2024-01-17
----------------

# Nomore í”„ë¡œì íŠ¸ - 1ì¼ì°¨

## Infra
> ì£¼ì œ : ì—ë„ˆì§€ í”Œë«í¼

1. ê¸°ìˆ ìŠ¤íƒ ì„ ì •   
FE : react/ngnix   
BE : springboot/tomcat   
Cloud : aws/ec2/ubuntu + Docker   
SCMT : nothion, git, github   
CI/CD : github actions   
<br><br>




2. ì¸í”„ë¼ êµ¬ì¶•   
(1) AWS EC2 (Ubuntu)ì¸ìŠ¤í„´ìŠ¤ ìƒì„±   
(2) ì„œë²„ êµ¬ë™   
(3) docker ì„¤ì¹˜   

- ê´€ë¦¬ì ê¶Œí•œ ì£¼ê¸°   
```bash
sudo su
```   

- íŒ¨í‚¤ì§€ ëª©ë¡ ì—…ë°ì´íŠ¸
```bash
apt-get update
```

- ëª¨ë“  íŒ¨í‚¤ì§€ ìµœì‹  ë²„ì ¼ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ
```bash
apt-get upgrade
```

- í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
```bash
apt-get install apt-transport-https ca-certificates curl gnupg-agent software-properties-common
```

- Dockerì˜ ê³µì‹ GPGí‚¤ë¥¼ ì¶”ê°€
```bash
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
```

- Dockerì˜ ê³µì‹ apt ì €ì¥ì†Œë¥¼ ì¶”ê°€
```bash
add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"
```

- íŒ¨í‚¤ì§€ ëª©ë¡ ì—…ë°ì´íŠ¸
```bash
apt-get update
```

-  Docker ì„¤ì¹˜
```bash
apt-get install docker-ce docker-ce-cli containerd.io
```

- Docker-Compose ì„¤ì¹˜
```bash
curl \
-L "https://github.com/docker/compose/releases/download/1.26.2/docker-compose-$(uname -s)-$(uname -m)" \
-o /usr/local/bin/docker-compose
```

- Docker-Compose ì‹¤í–‰ ê¶Œí•œ ì£¼ê¸°
```bash
chmod +x /usr/local/bin/docker-compose
```
(4) dockerhub ê°€ì… ë° ì—‘ì„¸ìŠ¤ í† í° ë‹¤ìš´ë°›ê³ (Access Token Description : Feat) c:/deploy/ ì— docker_token.txt íŒŒì¼ë¡œ ì €ì¥   
(5) ë„ì»¤ ì»´í“¨í„°ì— ë‹¤ìš´ë¡œë“œ
(6) ë„ì»¤ ë¡œê·¸ì¸(ì•„ì´ë”” : ë„ì»¤ í™ˆí˜ì´ì§€ ì•„ì´ë”” / ë¹„ë°€ë²ˆí˜¸ : docker_token.txt ë‚´ë¶€ ì“°ì—¬ìˆëŠ” íŒ¨ìŠ¤ì›Œë“œ)
```bash
docker login
```
(6) Nginx ì„¤ì¹˜   
- Nginx ì„¤ì¹˜   
```bash
docker pull nginx
``` 
- docker container run   
```bash
docker container run --name nginxserver -d -p 80:80 nginx
```
    
(7) Nginx ì„¤ì •
- Nginx ì»¨í…Œì´ë„ˆì— ë“¤ì–´ê°€ê¸°
```bash
docker exec -it nginxserver bash
```
- /etc/nginx/conf.d#/ ë¡œ ì´ë™
```bash
cd /etc/nginx/conf.d#
```
- íŒ¨í‚¤ì§€ ëª©ë¡ ì—…ë°ì´íŠ¸
```bash
apt-get upgrade
```
- vim ì—ë””í„° ì„¤ì¹˜
```bash
apt-get install vim
```
- vim ì—ë””í„° ì—´ê¸°
```bash
vim default.conf
```
- a ë¥¼ ëˆ„ë¥´ê³  í¸ì§‘ëª¨ë“œon í›„ ë°‘ ì½”ë“œ ì ìš©   
    - vim ì—ë””í„° ê°„ë‹¨ ë‹¨ì¶•í‚¤
        - ë‚˜ê°€ê¸° <b>:q</b>
        - ì €ì¥í•˜ê¸° <b>:w</b>
        - ì €ì¥í•˜ê³  ë‚˜ê°€ê¸° <b>:wq</b>
        - ë’¤ë¡œê°€ê¸° <b>u</b>
        - í¸ì§‘ëª¨ë“œon <b>a</b>
        - í¸ì§‘ëª¨ë“œoff <b>esc</b>

```bash
upstream blue {
        server 172.31.4.201:8080;
}
upstream green {
        server 172.31.4.201:8081;
}
server {
    listen  80;
    listen [::]80;
    server_name localhost;

    #access_log /var ~~

    include /etc/nginx/conf.d/service-env.inc;

    location / {
        proxy_pass http://$service_url;

        proxy_set_header X-Real_IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header Host $http_host;

        root /usr/share/nginx/html;
        index index.html index.htm;
    }

}
```
- service-env.inc íŒŒì¼ ìƒì„± í›„ ë°‘ ì½”ë“œì™€ ê°™ì´ í¸ì§‘($service_url ì„ green ìœ¼ë¡œ set)   
    - â­ ë¬´ì¤‘ë‹¨ ë°°í¬ : 8080, 8081 í¬íŠ¸ ë‘˜ ë‹¤ ì‚¬ìš©
```bash
set $service_url green;
```


## ğŸƒ Springboot


## â™¾ï¸ React


# ì •ë³´ì²˜ë¦¬ê¸°ì‚¬ í•„ê¸° ê³µë¶€
ì´ì „ ê³µë¶€í–ˆë˜ ë‚´ìš© ë³µìŠµ